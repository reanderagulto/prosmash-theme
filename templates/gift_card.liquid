{% layout none %}
<!doctype html>
<html class="no-js" lang="{{ request.locale.iso_code }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  {%- if canonical_url != blank  -%}
    <link rel="canonical" href="{{ canonical_url }}">
  {%- endif -%}

  {%- if settings.favicon != blank -%}
    <link rel="shortcut icon" href="{{ settings.favicon | img_url: '32x32' }}" type="image/png">
  {%- endif -%}

  {%- capture seo_title -%}
    {%- if request.page_type == 'search' and search.performed == true -%}
      {{ 'general.search.heading' | t: count: search.results_count }}: {{ 'general.search.results_with_count' | t: terms: search.terms, count: search.results_count }}
    {%- else -%}
      {{ page_title }}
    {%- endif -%}
    {%- if current_tags -%}
      {%- assign meta_tags = current_tags | join: ', ' -%} &ndash; {{ 'general.meta.tags' | t: tags: meta_tags -}}
    {%- endif -%}
    {%- if current_page != 1 -%}
      &ndash; {{ 'general.meta.page' | t: page: current_page }}
    {%- endif -%}
    {%- assign escaped_page_title = page_title | escape -%}
    {%- unless escaped_page_title contains shop.name -%}
      &ndash; {{ shop.name }}
    {%- endunless -%}
  {%- endcapture -%}
  <title>{{ seo_title | strip }}</title>


  <style>
    body {
      background-color: white;
      margin: 0;
    }
  </style>

  {{ 'sectionhub.css' | asset_url | stylesheet_tag }}
  {{ 'sectionhub-weare.css' | asset_url | stylesheet_tag }}
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  {%- if request.page_type contains 'customers/' -%}
    <script src="{{ 'shopify_common.js' | shopify_asset_url }}"></script>
  {%- endif -%}
  
  {{ 'vendor/qrcode.js' | shopify_asset_url | script_tag }}  
  {{ content_for_header }}
</head>

<body class="mdp template-{{ request.page_type | handle }}">

  {%- assign formatted_initial_value = gift_card.initial_value | money_without_trailing_zeros: gift_card.currency -%}
  {%- assign formatted_initial_value_stripped = formatted_initial_value | strip_html -%}
  {%- assign initial_value_size = formatted_initial_value | size -%}
  {%- assign code_size = gift_card.code | format_code | size -%}
  
  <div class="mdp-giftcard">
    
    <div class="mdp-header">
      <div class="mdp-shop">
        <a href="{{ shop.url }}" class="">{{ shop.name }}</a>
      </div>

      <h1>{{ 'gift_cards.issued.subtext' | t }}</h1>
      {% unless gift_card.enabled %}
      <div class="mdp-tag">{{ 'gift_cards.issued.disabled' | t }}</div>
      {% endunless %}
      {% assign gift_card_expiry_date = gift_card.expires_on | date: format: "basic" %}
      {% if gift_card.expired and gift_card.enabled %}
      <div class="mdp-tag">{{ 'gift_cards.issued.expired' | t: expiry: gift_card_expiry_date }}</div>
      {% endif %}
      {% if gift_card.expired != true and gift_card.expires_on and gift_card.enabled %}
      <div class="mdp-tag mdp-active">{{ 'gift_cards.issued.active' | t: expiry: gift_card_expiry_date }}</div>
      {% endif %}
      
      <div class="mdp-giftcard-amount{% if initial_value_size > 6 %} mdp-amount-medium{% endif %}">
        {% if gift_card.balance != gift_card.initial_value %}
        <span class="mdp-tooltip">
          <span class="mdp-label">{{ 'gift_cards.issued.remaining_html' | t: balance: gift_card.balance | money }}</span>
        </span>
        {% endif %}
        <strong>{{ formatted_initial_value }}</strong>
      </div>      
    </div>
    <div class="mdp-wrapper">
      <img src="{{ 'gift-card/card.jpg' | shopify_asset_url }}" alt="">

      <div class="">
        {{ 'gift_cards.issued.redeem_html' | t: value: formatted_initial_value_stripped }}
      </div>

      <div id="QrCode" class="mdp-qr-code" data-identifier="{{ gift_card.qr_identifier }}"></div>

      <div class="mdp-code">
        <div class="mdp-code-inner">
          <input type="text"
                 class="mdp-code-text{% if gift_card.expired or gift_card.enabled != true %} disabled{% endif %}"
                 id="GiftCardDigits"
                 value="{{ gift_card.code | format_code }}"
                 readonly />
        </div>
      </div>
      
      <div class="mdp-action-list">
        <div class="mdp-item">
          <a href="{{ shop.url }}"
             class="btn"
             target="_blank"
             rel="noopener">
            {{ 'gift_cards.issued.shop_link' | t }}
          </a>
        </div>
        <div class="mdp-item">
          <button type="button" class="" onclick="window.print();">
            {{ 'gift_cards.issued.print' | t }}
          </button>
        </div>
        {% if gift_card.pass_url %}
        <div>
          <a class="mdp-apple-wallet" href="{{ gift_card.pass_url }}">
            <img class="" src="{{ 'gift-card/add-to-apple-wallet.svg' | shopify_asset_url }}" width="120" height="40" alt="{{ 'gift_cards.issued.add_to_apple_wallet' | t }}">
          </a>
        </div>
        {% endif %}
      </div>
    </div>
  </div>

  <script>    
    jQuery(function() {
      var config = {
        qrCode: '#QrCode',
        printButton: '#PrintGiftCard',
        giftCardCode: '#GiftCardDigits'
      };
      var $qrCode = jQuery(config.qrCode);
      new QRCode($qrCode[0], {
        text: $qrCode.attr('data-identifier'),
        width: 120,
        height: 120//,
        //imageAltText: theme.strings.qrImageAlt
      });

      jQuery(config.printButton).on('click', function() {
        window.print();
      });

      jQuery(config.giftCardCode).on('focus', this.select);
    });
  </script>

</body>
</html>
