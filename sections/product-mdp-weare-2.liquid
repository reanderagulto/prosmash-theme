{{"product-mdp-weare-2.css" | asset_url | stylesheet_tag }}

{% if section.settings.selected_product != blank %}
	{% assign current_product = all_products[section.settings.selected_product] %}
{% else %}
	{% assign current_product = product %}
{% endif %}

{% assign variant = current_product.selected_or_first_available_variant %}
<script>
    if (!('mdp' in window)) {
        window.mdp = {};
    }
    window.mdp.money_format = '{{shop.money_format}}';
</script>
<div id="mdp-weare-{{ section.id }}" class="mdp mdp-container mdp-weare-single-product" style="margin-top: {{ section.settings.margin_top }}px; margin-bottom: {{ section.settings.margin_bottom }}px;">
  <div class="mdp-product">
    <div class="mdp-sticky-sidebar">
    	<div class="mdp-media">
      {% if section.settings.slider %}
      <div class="mdp-swiper-container mdp-swiper-thumbs" data-direction="vertical"  data-spaceBetween="5" data-slidesPerView="auto" data-mousewheel="true" data-pagination="false" data-navigation="false">
        <div class="mdp-swiper-wrapper">
          {% for media in current_product.media %}
            {% case media.media_type %}
              {% when 'image' %}
                <div class="mdp-swiper-slide">
                  <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
                    <img class="mdp-image lazyload" data-src="{{media.preview_image | img_url : section.settings.image_size}}" alt="{{media.preview_image.alt}}" >
                  </div>
                </div>
              {% when 'external_video' %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
                    <img class="mdp-image lazyload" data-src="{{media.preview_image | img_url : section.settings.image_size}}" alt="{{media.preview_image.alt}}" >
                  </div>
                </div>
              {% when 'video' %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
                    <img class="mdp-image lazyload" data-src="{{media.preview_image | img_url : section.settings.image_size}}" alt="{{media.preview_image.alt}}" >
                  </div>
                </div>
              {% when 'model' %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
                    <img class="mdp-image lazyload" data-src="{{media.preview_image | img_url : section.settings.image_size}}" alt="{{media.preview_image.alt}}" >
                  </div>
                </div>
              {% else %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
                    <img class="mdp-imag lazyloade" data-src="{{media.preview_image | img_url : section.settings.image_size}}" alt="{{media.preview_image.alt}}" >
                  </div>
                </div>
            {% endcase %}          
          {% endfor %}          
        </div>
      </div>      
      <div class="mdp-product-swiper mdp-swiper-container" data-loop="true" data-pagination="false">
        <div class="mdp-swiper-wrapper">
          {% for media in current_product.media %}
            {% case media.media_type %}
              {% when 'image' %}
                <div class="mdp-swiper-slide {% if section.settings.zoom %}mdp-hover-zoom{% endif %}" data-zoom="{{media | img_url : '2000x'}}" data-media-id="{{ media.id }}">
                  <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
                    <img class="mdp-image lazyload" data-src="{{media | img_url : section.settings.image_size}}" alt="{{media.alt}}" >
                  </div>
                </div>
              {% when 'external_video' %}
                <div class="mdp-swiper-slide" style="padding-top: {{ 1 | divided_by: media.aspect_ratio | times: 100}}%;">
                  {{ media | external_video_tag }}
                </div>
              {% when 'video' %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  {{ media | video_tag: controls: true }}
                </div>
              {% when 'model' %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  {{ media | model_viewer_tag }}
                </div>
              {% else %}
                <div class="mdp-swiper-slide" data-media-id="{{ media.id }}">
                  {{ media | media_tag }}
                </div>
            {% endcase %}          
          {% endfor %}                    
        </div>
        <div class="mdp-swiper-button-prev"></div>
        <div class="mdp-swiper-button-next"></div>
      </div>      
      {% else %}      
      <div class="mdp-placeholder" style="padding-top: calc({{ section.settings.image_size | split: "_" | first | split: "x" | last }} / {{ section.settings.image_size | split: "x" | first }} * 100%);">
        <img class="mdp-image lazyload" data-src="{{current_product.featured_image | img_url : section.settings.image_size}}" alt="{{current_product.featured_image.alt}}" >
      </div>
      {% endif %}      
      {% if current_product.available %}
        {% if current_product.compare_at_price > current_product.price %}
	        <div class="mdp-sale">
              {{ section.settings.sale_string }}      
              {{ current_product.compare_at_price | minus: current_product.price | times: 100 | divided_by: current_product.compare_at_price }}%
            </div>
        {% else %}
          {% if current_product.tags contains 'new' %}
              <div class="mdp-new">
                {{ section.settings.new_string }}      
              </div>
          {% endif %}
      	{% endif %}
      {% else %}
        <div class="mdp-sold-out">
          {{ section.settings.sold_out_string }}
        </div>
      {% endif %}
    </div>
    </div>
    <div class="mdp-data">
      {% render 'mdp-weare-product-blocks', current_product: current_product, variant: variant %}
    </div> 
    <script type="application/json" class="mdp-product-json">
      {{ current_product | json }}
    </script>
  </div>
  <div class="mdp-tabs">
    <div class="mdp-titles">
      <span data-target="#{{ current_product.title | handleize }}-description">{{ section.settings.description_string }}</span>
      <span data-target="#{{ current_product.title | handleize }}-reviews">{{ section.settings.reviews_string }}</span>
    </div>
    <div class="mdp-content">
      <div class="mdp-item mdp-description" id="{{ current_product.title | handleize }}-description">
        {{ current_product.description }}
      </div>
      <div class="mdp-item" id="{{ current_product.title | handleize }}-reviews">
        <div id="looxReviews" data-product-id="{{product.id}}" class="loox-reviews-default">{{ product.metafields.loox.reviews }}</div>
      </div>            
    </div>
  </div>    
</div>


{% schema %}
  {
    "name": "Single product 2",
	"blocks": [
      {
        "type": "title",
        "name": "Title"
      },
      {
        "type": "rating",
        "name": "Rating"
      },
      {
        "type": "price",
        "name": "Price"
      },
      {
        "type": "sku",
        "name": "SKU"
      },
      {
        "type": "metafield",
        "name": "Metafield",
        "settings": [
          {
            "type": "text",
            "id": "name",
            "label": "Name",
			"default": "Metafield 1"
          },
          {
            "type": "text",
            "id": "namespace",
            "label": "Namespace"
          },
          {
            "type": "text",
            "id": "key",
            "label": "Key"
          }
        ]
      },
      {
        "type": "payment_terms",
        "name": "Payment terms"
      },
      {
        "type": "visitors",
        "name": "Visitors",
        "settings": [
          {
             "type":      "text",
             "id":        "min",
             "label":     "Live views min",
             "default":   "20"
          },
          {
             "type":      "text",
             "id":        "max",
             "label":     "Live views max",
             "default":   "30"
          },
          {
             "type":      "text",
             "id":        "duration",
             "label":     "Live views duration (sec)",
             "default":   "10"
          },
          {
             "type":      "text",
             "id":        "text",
             "label":     "Text",
             "default":   "people are viewing this right now"
          }
        ]
      },
      {
        "type": "options",
        "name": "Options",
        "settings": [
          {
             "type":      "radio",
             "id":        "variants_group",
             "label":     "Variants group",
             "options": [
               { "value": "together", "label": "Together" },
               { "value": "separately", "label": "Separately" }
             ],
             "default":   "separately"
          }
        ]
      },
      {
        "type": "buttons",
        "name": "Buttons"
      },
      {
        "type": "dynamic_checkout",
        "name": "Dynamic checkout"
      },
      {
        "type": "availability",
        "name": "Availability"
      },
      {
        "type": "description",
        "name": "Description",
        "settings": [
          {
            "type": "range",
            "id": "excerpt_words",
            "label": "Excerpt words number",
            "info": "Set 0 if no need to truncate description",
            "default": 0,
            "min": 0,
            "max": 500,
            "step": 10
          },
          {
            "type": "text",
            "id": "excerpt_ellipsis",
            "label": "Excerpt ellipsis",
            "default": "..."
          }
        ]
      },
      {
        "type": "share",
        "name": "Share"
      },
      {
		"type": "@app"
      },
      {
        "type": "custom_liquid",
        "name": "Custom liquid",
        "settings": [
          {
            "type": "liquid",
            "id": "custom_liquid",
            "label": "Custom liquid"
          }
        ]
      }
    ],
    "settings": [
      {
        "type": "product",
        "id": "selected_product",
        "label": "Product"
      },
      {
         "type":      "radio",
         "id":        "variants_group",
         "label":     "Variants group",
         "options": [
           { "value": "together", "label": "Together" },
           { "value": "separately", "label": "Separately" }
         ],
         "default":   "separately"
      },
      {
         "type": "text",
         "id": "image_size",
         "label": "Product size",
         "default": "800x800_crop_center",
         "info": "Set the image size: '600x600',\n '2048x',\n'original' or '370x370_crop_center'"
      },
      {
        "type": "checkbox",
        "id": "slider",
        "label": "Images slider",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "zoom",
        "label": "Images zoom",
        "default": true
      },
      {
        "type": "checkbox",
        "id": "stars",
        "label": "Star rating",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "redirect",
        "label": "Redirect to cart page",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "dynamic_checkout",
        "label": "Dynamic checkout buttons",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "social_sharing",
        "label": "Social sharing",
        "default": true
      },
      {
        "type": "range",
        "id": "excerpt_words",
        "label": "Excerpt words number",
		"info": "Set 0 if no need to truncate description",
        "default": 0,
        "min": 0,
        "max": 500,
        "step": 10
      },
      {
        "type": "text",
        "id": "excerpt_ellipsis",
        "label": "Excerpt ellipsis",
        "default": "..."
      },
      {
		"type": "header",
		"content": "Strings"
	  },
      {
         "type": "text",
         "id": "sold_out_string",
         "label": "'Sold out' string",
         "default": "Sold out"
      },
      {
         "type": "text",
         "id": "sale_string",
         "label": "'Sale' string",
         "default": "Sale"
      },
      {
         "type": "text",
         "id": "new_string",
         "label": "'New' string",
         "default": "New"
      },
      {
         "type": "text",
         "id": "add_cart_string",
         "label": "'Add cart' string",
         "default": "Add to cart"
      },
      {
         "type": "text",
         "id": "description_string",
         "label": "'Description' string",
         "default": "Description"
      },
      {
         "type": "text",
         "id": "reviews_string",
         "label": "'Reviews' string",
         "default": "Reviews"
      },
      {
        "type": "text",
        "id": "margin_top",
        "label": "Margin top (px)"
      },
      {
        "type": "text",
        "id": "margin_bottom",
        "label": "Margin bottom (px)"
      }
    ],
    "presets": [{
      "name": "Single product Desc Bottom",
      "category": "SectionHub: weare",
      "blocks": [
        {
        "type": "title"
        },
        {
        "type": "price"
        },
        {
        "type": "payment_terms"
        },
        {
        "type": "options"
        },
        {
        "type": "buttons"
        },
        {
        "type": "dynamic_checkout"
        },
        {
        "type": "availability"
        },
        {
        "type": "share"
        }
      ]
    }]
  }
{% endschema %}