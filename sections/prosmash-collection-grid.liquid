<section class="prosmash-collection-grid">
  <div class="custom-container">

  <div class="product-count">
    {{ collection.title }} ({{ collection.products_count }})
  </div>

    <div class="filter">
        {% if collection.sort_options.size > 1 %}
            <form method="get" class="collection-sort-form" id="SortByForm">
                <label for="SortBy" class="visually-hidden">Sort by</label>
                <select name="sort_by" id="SortBy" onchange="this.form.submit()">
                {% for option in collection.sort_options %}
                    <option value="{{ option.value }}" {% if option.value == collection.sort_by %}selected{% endif %}>
                    {{ option.name }}
                    </option>
                {% endfor %}
                </select>
            </form>
        {% endif %}

    </div>
    <div class="collection-grid">
  {% for product in collection.products %}
    <div class="collection-grid-item">
      <a href="{{ product.url }}">
        <!-- Featured Image -->
        <img src="{{ product.featured_image | image_url: width: 400 }}" alt="{{ product.title }}">
        <!-- Gallery Thumbnails -->
        <div class="product-thumbnails">
            {% for media in product.media limit: 4 %}
            {% if media.media_type == 'image' %}
                <img
                src="{{ media.preview_image | image_url: width: 100 }}"
                alt="{{ product.title }} thumbnail"
                class="thumbnail-img">
            {% endif %}
            {% endfor %}
        </div>
      </a>

      <h3>{{ product.title }}</h3>
      <!-- âœ… Stock Display -->
      {% assign inventory = product.variants.first.inventory_quantity %}
      {% if inventory > 0 %}
        <p>{{ inventory }} in stock</p>
      {% else %}
        <p class="out-of-stock">Out of stock</p>
      {% endif %}
      <p>{{ product.price | money }}</p>

      <!-- Buttons -->
      <div class="product-buttons">
        <!-- View Product -->
        <a href="{{ product.url }}" class="btn view-btn">View Product</a>

        <!-- Add to Cart -->
        {% if inventory > 0 %}
          <form method="post" action="/cart/add">
            <input type="hidden" name="id" value="{{ variant.id }}">
            <button type="submit" class="btn add-cart-btn">Add to Cart</button>
          </form>
        {% else %}
          <button class="btn add-cart-btn" disabled>Out of Stock</button>
        {% endif %}
      </div>

    </div>
  {% endfor %}
</div>

  </div>
</section>

{% schema %}
  {
    "name": "Collection Grid",
    "settings": [

    ],	
    "presets": [{
      "name": "Prosmash Collection Grid",
      "category": "Prosmash: Collection"
    }]
  }
{% endschema %}