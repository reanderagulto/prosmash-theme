{{"slideshow-product-home-12.css" | asset_url | stylesheet_tag }}

<div id="mdp-weare-{{ section.id }}"
     class="mdp mdp-weare-slideshow-product-home-12 mdp-container-full-width"
     style="{% if section.settings.margin_top != blank %}
                margin-top: {{ section.settings.margin_top }}px;
            {% endif %}
            {% if section.settings.margin_bottom != blank %}
                margin-bottom: {{ section.settings.margin_bottom }}px;
            {% endif %}">
    <div class="mdp-swiper-container swiper-slideshow-home-12 swiper-slideshow-{{ section.id }}">
        <div class="swiper-wrapper mdp-swiper-wrapper">
            {% for block in section.blocks %}
                <div class="swiper-slide mdp-swiper-slide">
                    {% case block.type %}
                        {% when 'slide' %}
                            <div class="mdp-slide mdp-grid"
                                 data-columns="2"
                                 data-gap="30">
                                <div class="mdp-media lazyload">
                                    <img src="{{block.settings.image | img_url : '920x920_crop_center' }}" alt="" />
                                </div>
                                <div id="mdp-grid-box-{{ section.id }}"
                                     class="mdp-data">
                                    <div class="mdp-content-box">

                                        <div class="mdp-header">
                                            <p class="mdp-subtitle"> {{block.settings.subtitle}} </p>
                                            <h1 class="mdp-title"> {{block.settings.title}} </h1>
                                        </div>

                                        {% if block.settings.content != blank %}
                                            <div class="mdp-content">
                                                {{block.settings.content}}
                                            </div>
                                        {% endif %}

                                        <div class="mdp-footer">
                                            {% render 'mdp-weare-social-sharing' %}
                                            <div id="mdp-grid-{{ section.id }}"
                                                 class="mdp-items-box mdp-grid"
                                                 data-columns="3"
                                                 data-gap="25">
                                                {% for product in block.settings.product_list %}
                                                    <div class="mdp-product-item">
                                                        <div class="mdp-product-media">
                                                            {% for media in product.media %}
                                                                {% case media.media_type %}
                                                                    {% when 'image' %}
                                                                        <img src="{{media.preview_image | img_url : '300x400_crop_center' }}"
                                                                             class="mdp-img-product"
                                                                             alt="{{media.preview_image.alt}}" >
                                                                    {% else %}
                                                                        <img src="{{media.preview_image | img_url : '300x400_crop_center' }}"
                                                                             class="mdp-img-product"
                                                                             alt="{{media.preview_image.alt}}" >
                                                                {% endcase %}
                                                            {% endfor %}
                                                        </div>

                                                        <div class="mdp-data-info">
                                                            <a href="{{ product.url }}" class="mdp-link-product">{{ product.title }}</a>
                                                            {% render 'product-price', product: product %}
                                                        </div>

                                                    </div>
                                                {% endfor %}
                                            </div>
                                            {% if block.settings.link != blank %}
                                                <a class="mdp-button"
                                                   href="{{block.settings.link}}"> {{block.settings.button_string}} </a>
                                            {% endif %}
                                        </div>

                                    </div>
                                </div>
                            </div>
                    {% endcase %}
                </div>
            {% endfor %}
        </div>

        <div class="swiper-button-prev swiper-button-prev-slideshow-home-12 swiper-button-prev-slideshow-{{ section.id }}"></div>
        <div class="swiper-button-next swiper-button-next-slideshow-home-12 swiper-button-next-slideshow-{{ section.id }}"></div>

    </div>
</div>

<script>
    {% if request.design_mode == true %}
    function designModeGrid() {
        let slider_{{ section.id | replace: "--", "" | replace: "-", "" }} = document.querySelector("#mdp-grid-{{ section.id }}");
        let data_{{ section.id | replace: "--", "" | replace: "-", "" }} = slider_{{ section.id | replace: "--", "" | replace: "-", "" }}.getAttribute('data-columns') || {};
        let dataOptions = JSON.parse(data_{{ section.id | replace: "--", "" | replace: "-", "" }});

        /** Calculate the height of the image depending on the length of the container */
        function breakpointsWidthCol_{{ section.id | replace: "--", "" | replace: "-", "" }}(width) {

            let perView = dataOptions;

            if (width >= 769 && width <= 1024) {
                perView = 3;
            }

            if (width >= 426 && width <= 768) {
                perView = 2;
            }

            if (width >= 320 && width <= 425) {
                perView = 1;
            }

            return perView;
        }

        function images_form_{{ section.id | replace: "--", "" | replace: "-", "" }}( width, imagesForm ){

            if (width >= 769 && width <= 1024) {
                imagesForm = 0;
            }

            return imagesForm;
        }

        function heightImgCol_{{ section.id | replace: "--", "" | replace: "-", "" }}() {
            let winWidthPage = window.innerWidth;
            let grid = document.getElementById("mdp-grid-box-{{ section.id }}");
            let winWidth = grid.offsetWidth;
            let perView = breakpointsWidthCol_{{ section.id | replace: "--", "" | replace: "-", "" | replace: "-", "" }}(winWidthPage);
            let allGap = winWidthPage >= 376 ? perView * 15 : 0;
            let paddingSide = '{{ section.settings.boxed }}' === 'false' && winWidthPage >= 1025 ? 80 * 2 : 15 * 2;
            let winWidthGap = winWidth - allGap - paddingSide;
            let colSize = 100 / perView;
            let height = (winWidthGap * colSize / 100) + images_form_{{ section.id | replace: "--", "" | replace: "-", "" }}( winWidthPage, {{ section.settings.images_form }} );
            let item = grid.querySelectorAll(".mdp-img-product");

            for (let i = 0; i <= item.length - 1; i++) {
                item[i].setAttribute("style", `height: ${Math.round(height)}px;`);
            }
        }

        addEventListener("resize", (event) => {
            heightImgCol_{{ section.id | replace: "--", "" | replace: "-", "" }}();
        });

        heightImgCol_{{ section.id | replace: "--", "" | replace: "-", "" }}();
        /** End */
    }

    document.addEventListener("shopify:section:load", designModeGrid);
    {% endif %}

    let slider_{{ section.id | replace: "--", "" | replace: "-", "" }} = document.querySelector("#mdp-grid-{{ section.id }}");
    let data_{{ section.id | replace: "--", "" | replace: "-", "" }} = slider_{{ section.id | replace: "--", "" | replace: "-", "" }}.getAttribute('data-columns') || {};
    let dataOptions_{{ section.id | replace: "--", "" | replace: "-", "" }} = JSON.parse(data_{{ section.id | replace: "--", "" | replace: "-", "" }});

    /** Calculate the height of the image depending on the length of the container */
    function breakpointsWidthCol_{{ section.id | replace: "--", "" | replace: "-", "" }}(width) {

        let perView = dataOptions_{{ section.id | replace: "--", "" | replace: "-", "" }};

        if (width >= 769 && width <= 1024) {
            perView = 3;
        }

        if (width >= 426 && width <= 768) {
            perView = 2;
        }

        if (width >= 320 && width <= 425) {
            perView = 1;
        }

        return perView;
    }

    function images_form_{{ section.id | replace: "--", "" | replace: "-", "" }}( width, imagesForm ){

        if (width >= 769 && width <= 1024) {
            imagesForm = 0;
        }

        return imagesForm;
    }

    function heightImgCol_{{ section.id | replace: "--", "" | replace: "-", "" }}() {
        let winWidthPage = window.innerWidth;
        let grid = document.getElementById("mdp-grid-box-{{ section.id }}");
        let winWidth = grid.offsetWidth;
        let perView = breakpointsWidthCol_{{ section.id | replace: "--", "" | replace: "-", "" | replace: "-", "" }}(winWidthPage);
        let allGap = winWidthPage >= 376 ? perView * 15 : 0;
        let paddingSide = '{{ section.settings.boxed }}' === 'false' && winWidthPage >= 1025 ? 80 * 2 : 15 * 2;
        let winWidthGap = winWidth - allGap - paddingSide;
        let colSize = 100 / perView;
        let height = (winWidthGap * colSize / 100) + images_form_{{ section.id | replace: "--", "" | replace: "-", "" }}( winWidthPage, {{ section.settings.images_form }} );
        let item = grid.querySelectorAll(".mdp-img-product");

        for (let i = 0; i <= item.length - 1; i++) {
            item[i].setAttribute("style", `height: ${Math.round(height)}px;`);
        }

    }

    heightImgCol_{{ section.id | replace: "--", "" | replace: "-", "" }}();

    addEventListener("resize", (event) => {
        heightImgCol_{{ section.id | replace: "--", "" | replace: "-", "" }}();
    });
    /** End */

    const swiperSlideshowHome12_{{ section.id | replace: "-", "_" }} = new Swiper('.swiper-slideshow-{{ section.id }}', {
        // Optional parameters
        lidesPerView: 'auto',
        direction: 'horizontal',
        slidesPerView: 1,
        centeredSlides: false,
        speed: 500,
        spaceBetween: 30,
        loop: false,
        autoplay: {
            delay: 5000,
        },
        effect: 'slide',
        allowTouchMove: true,
        freeMode: true,
        watchSlidesVisibility: true,
        watchSlidesProgress: true,
        hashNavigation: false,

        // Navigation arrows
        navigation: {
            nextEl: '.swiper-button-next-slideshow-{{ section.id }}',
            prevEl: '.swiper-button-prev-slideshow-{{ section.id }}',
        }
    });

    swiperSlideshowHome12_{{ section.id | replace: "-", "_" }}.init();
</script>

{% schema %}
{
  "name": "Slideshow product home 12",
  "settings": [
    {
      "type": "text",
      "id": "images_form",
      "label": "Images form for products",
      "default": "0",
      "info": "If the shape of the image does not suit you in terms of height, enter in the field the number of pixels by which the desired height will increase."
    },
    {
      "type": "text",
      "id": "margin_top",
      "label": "Margin top (px)"
    },
    {
      "type": "text",
      "id": "margin_bottom",
      "label": "Margin bottom (px)"
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "subtitle",
          "label": "Sub heading",
          "default": "Sub heading"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Heading"
        },
        {
          "type": "html",
          "id": "content",
          "label": "Content"
        },
        {
          "type": "product_list",
          "id": "product_list",
          "label": "Products",
          "limit": 3
        },
        {
          "type": "text",
          "id": "button_string",
          "label": "Button text",
          "default": "Get more info"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        },
        {
          "type": "checkbox",
          "id": "inverted",
          "label": "Inverted",
          "default": false
        }
      ]
    }
  ],
  "presets": [{
    "name": "Slideshow product home 12",
    "category": "SectionHub: We√§re "
  }]
}
{% endschema %}